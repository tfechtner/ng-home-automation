{
    "apps": [
        {
            "name": "nest-home-backend-server",
            "script": "backend/dist/main.js",
            "error_file": "./logs/err.log",
            "out_file": "./logs/out.log",
            "log_date_format" : "YYYY-MM-DD HH:mm Z",
            "instances": 1,
            "autorestart": true,
            "watch": false,
            "max_memory_restart": "1G",
            "env": {
                "NODE_ENV": "development"
            },
            "env_production": {
                "NODE_ENV": "production"
            }
        },
        {
            "name": "nest-home-frontend-server",
            "script": "frontend-server/dist/server.js",
            "instances": 1,
            "autorestart": true,
            "watch": false,
            "max_memory_restart": "1G",
            "env": {
                "NODE_ENV": "development"
            },
            "env_production": {
                "NODE_ENV": "production"
            }
        },
        {
            "name": "nest-home-sonos-api",
            "script": "sonos/node-sonos-http-api/server.js",
            "instances": 1,
            "autorestart": true,
            "watch": false,
            "max_memory_restart": "1G",
            "env": {
                "NODE_ENV": "development"
            },
            "env_production": {
                "NODE_ENV": "production"
            }
        }
    ],
    "deploy": {
        "prod": {
            "host": ["work-MacMiniNest"],
            "ref": "origin/develop",
            "repo": "git@tfechtner-Github:tfechtner/ng-home-automation.git",
            "path": "/Users/work/Workspace/ng-home-automation",
            "post-deploy": "source ~/.zshrc && cd backend && npm install && npm run prestart:prod && cd .. && cd frontend-server && npm install && npm run build && cd .. && cd frontend && npm install && npm run build:prod && cd .. && rm -rf ./frontend-server/www/* && cp -r ./frontend/dist/* ./frontend-server/www && pm2 reload ecosystem.json --env production"
        },
        "prod-backend": {
            "host": ["work-MacMiniNest"],
            "ref": "origin/develop",
            "repo": "git@tfechtner-Github:tfechtner/ng-home-automation.git",
            "path": "/Users/work/Workspace/ng-home-automation",
            "post-deploy": "source ~/.zshrc && cd backend && npm install && npm run prestart:prod && cd .. && pm2 reload ecosystem.json --env production --only nest-home-backend-server"
        },
        "prod-frontend": {
            "host": ["work-MacMiniNest"],
            "ref": "origin/develop",
            "repo": "git@tfechtner-Github:tfechtner/ng-home-automation.git",
            "path": "/Users/work/Workspace/ng-home-automation",
            "post-deploy": "source ~/.zshrc && cd frontend && npm install && npm run build:prod && cd .. && rm -rf ./frontend-server/www/* && cp -r ./frontend/dist/* ./frontend-server/www"
        },
        "prod-frontend-server": {
            "host": ["work-MacMiniNest"],
            "ref": "origin/develop",
            "repo": "git@tfechtner-Github:tfechtner/ng-home-automation.git",
            "path": "/Users/work/Workspace/ng-home-automation",
            "post-deploy": "source ~/.zshrc && cd frontend-server && npm install && npm run build && cd .. && pm2 reload ecosystem.json --env production --only nest-home-frontend-server"
        },
        "prod-sonos": {
            "host": ["work-MacMiniNest"],
            "ref": "origin/develop",
            "repo": "git@tfechtner-Github:tfechtner/ng-home-automation.git",
            "path": "/Users/work/Workspace/ng-home-automation",
            "post-deploy": "source ~/.zshrc && cd sonos/node-sonos-http-api && npm install && pm2 reload ecosystem.json --env production --only nest-home-sonos-api"
        }
    }
}
